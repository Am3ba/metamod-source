# vim: sts=2 ts=8 sw=2 tw=99 et ft=python:

lib = builder.compiler.StaticLibrary("version")
lib.compiler.defines.remove('MMS_USE_VERSIONLIB')
lib.compiler.sourcedeps += MMS.generated_headers
lib.sources += [
  'versionlib.cpp'
]

# Temporary Source2 hack. Always build linux with -m64
if builder.target_platform == 'linux':
  lib.compiler.cflags.remove('-m32')
  lib.compiler.cflags += ['-m64', '-fPIC']


cmd = builder.Add(lib)

rvalue = cmd.binary

